Prepare Batches:   0%|                                                       | 0/16 [00:00<?, ?it/s]                                                                                                    Epoch     1:   0%|                                                           | 0/16 [00:00<?, ?it/s]Epoch     1:   6%|███▏                                               | 1/16 [00:06<01:38,  6.54s/it]Epoch     1:  12%|██████▍                                            | 2/16 [01:17<10:20, 44.34s/it]Epoch     1:  19%|█████████▌                                         | 3/16 [01:20<05:32, 25.58s/it]Epoch     1:  25%|████████████▊                                      | 4/16 [01:23<03:20, 16.73s/it]Epoch     1:  31%|███████████████▉                                   | 5/16 [01:26<02:10, 11.83s/it]Epoch     1:  38%|███████████████████▏                               | 6/16 [01:31<01:32,  9.28s/it]Epoch     1:  44%|██████████████████████▎                            | 7/16 [01:34<01:05,  7.29s/it]Epoch     1:  50%|█████████████████████████▌                         | 8/16 [01:37<00:47,  6.00s/it]Epoch     1:  56%|████████████████████████████▋                      | 9/16 [01:40<00:35,  5.14s/it]Epoch     1:  62%|███████████████████████████████▎                  | 10/16 [01:44<00:27,  4.56s/it]Epoch     1:  69%|██████████████████████████████████▍               | 11/16 [01:47<00:20,  4.13s/it]Epoch     1:  75%|█████████████████████████████████████▌            | 12/16 [01:50<00:15,  3.86s/it]Epoch     1:  81%|████████████████████████████████████████▋         | 13/16 [01:53<00:11,  3.67s/it]Epoch     1:  88%|███████████████████████████████████████████▊      | 14/16 [01:56<00:06,  3.48s/it]Epoch     1:  94%|██████████████████████████████████████████████▉   | 15/16 [01:59<00:03,  3.36s/it]Epoch     1: 100%|██████████████████████████████████████████████████| 16/16 [02:03<00:00,  3.31s/it]                                                                                                    Epoch     1:   0%|                                                           | 0/16 [00:00<?, ?it/s]Epoch     1:   6%|███▏                                               | 1/16 [00:03<00:53,  3.57s/it]Epoch     1:  12%|██████▍                                            | 2/16 [00:06<00:47,  3.38s/it]Epoch     1:  19%|█████████▌                                         | 3/16 [00:09<00:42,  3.29s/it]Epoch     1:  25%|████████████▊                                      | 4/16 [00:13<00:38,  3.19s/it]Epoch     1:  31%|███████████████▉                                   | 5/16 [00:16<00:34,  3.16s/it]Epoch     1:  38%|███████████████████▏                               | 6/16 [00:19<00:31,  3.16s/it]Epoch     1:  44%|██████████████████████▎                            | 7/16 [00:22<00:27,  3.11s/it]Epoch     1:  50%|█████████████████████████▌                         | 8/16 [00:25<00:25,  3.13s/it]Epoch     1:  56%|████████████████████████████▋                      | 9/16 [00:28<00:21,  3.10s/it]Epoch     1:  62%|███████████████████████████████▎                  | 10/16 [00:31<00:18,  3.12s/it]Epoch     1:  69%|██████████████████████████████████▍               | 11/16 [00:34<00:15,  3.10s/it]Epoch     1:  75%|█████████████████████████████████████▌            | 12/16 [00:37<00:12,  3.11s/it]Epoch     1:  81%|████████████████████████████████████████▋         | 13/16 [00:41<00:09,  3.15s/it]Epoch     1:  88%|███████████████████████████████████████████▊      | 14/16 [00:44<00:06,  3.15s/it]Epoch     1:  94%|██████████████████████████████████████████████▉   | 15/16 [00:47<00:03,  3.15s/it]Epoch     1: 100%|██████████████████████████████████████████████████| 16/16 [00:50<00:00,  3.17s/it]                                                                                                    Epoch     1:   0%|                                                           | 0/16 [00:00<?, ?it/s]Epoch     1:   6%|███▏                                               | 1/16 [00:03<00:52,  3.53s/it]Epoch     1:  12%|██████▍                                            | 2/16 [00:06<00:45,  3.24s/it]Epoch     1:  19%|█████████▌                                         | 3/16 [00:09<00:41,  3.21s/it]Epoch     1:  25%|████████████▊                                      | 4/16 [00:12<00:38,  3.21s/it]Epoch     1:  31%|███████████████▉                                   | 5/16 [00:17<00:38,  3.53s/it]Epoch     1:  38%|███████████████████▏                               | 6/16 [00:20<00:34,  3.40s/it]Epoch     1:  44%|██████████████████████▎                            | 7/16 [00:23<00:30,  3.35s/it]Epoch     1:  50%|█████████████████████████▌                         | 8/16 [00:26<00:26,  3.27s/it]Epoch     1:  56%|████████████████████████████▋                      | 9/16 [00:29<00:22,  3.21s/it]Epoch     1:  62%|███████████████████████████████▎                  | 10/16 [00:32<00:19,  3.18s/it]Epoch     1:  69%|██████████████████████████████████▍               | 11/16 [00:35<00:15,  3.18s/it]Epoch     1:  75%|█████████████████████████████████████▌            | 12/16 [00:39<00:12,  3.15s/it]Epoch     1:  81%|████████████████████████████████████████▋         | 13/16 [00:42<00:09,  3.18s/it]Epoch     1:  88%|███████████████████████████████████████████▊      | 14/16 [00:45<00:06,  3.20s/it]Epoch     1:  94%|██████████████████████████████████████████████▉   | 15/16 [00:48<00:03,  3.22s/it]Epoch     1: 100%|██████████████████████████████████████████████████| 16/16 [00:51<00:00,  3.17s/it]                                                                                                    Epoch     1:   0%|                                                           | 0/16 [00:00<?, ?it/s]Epoch     1:   6%|███▏                                               | 1/16 [00:03<00:50,  3.34s/it]Epoch     1:  12%|██████▍                                            | 2/16 [00:06<00:45,  3.26s/it]Epoch     1:  19%|█████████▌                                         | 3/16 [00:09<00:41,  3.22s/it]Epoch     1:  25%|████████████▊                                      | 4/16 [00:12<00:38,  3.22s/it]Epoch     1:  31%|███████████████▉                                   | 5/16 [00:16<00:35,  3.18s/it]Epoch     1:  38%|███████████████████▏                               | 6/16 [00:20<00:34,  3.49s/it]Epoch     1:  44%|██████████████████████▎                            | 7/16 [00:49<01:47, 11.90s/it]Epoch     1:  50%|█████████████████████████▌                         | 8/16 [00:52<01:13,  9.14s/it]Epoch     1:  56%|████████████████████████████▋                      | 9/16 [00:55<00:51,  7.33s/it]Epoch     1:  62%|███████████████████████████████▎                  | 10/16 [00:59<00:36,  6.03s/it]Epoch     1:  69%|██████████████████████████████████▍               | 11/16 [01:02<00:25,  5.17s/it]Epoch     1:  75%|█████████████████████████████████████▌            | 12/16 [01:05<00:18,  4.56s/it]Epoch     1:  81%|████████████████████████████████████████▋         | 13/16 [01:08<00:12,  4.17s/it]Epoch     1:  88%|███████████████████████████████████████████▊      | 14/16 [01:11<00:07,  3.87s/it]Epoch     1:  94%|██████████████████████████████████████████████▉   | 15/16 [01:15<00:03,  3.66s/it]Epoch     1: 100%|██████████████████████████████████████████████████| 16/16 [01:18<00:00,  3.52s/it]                                                                                                    Epoch     1:   0%|                                                           | 0/16 [00:00<?, ?it/s]Epoch     1:   6%|███▏                                               | 1/16 [00:03<00:52,  3.48s/it]Epoch     1:  12%|██████▍                                            | 2/16 [00:06<00:47,  3.36s/it]Epoch     1:  19%|█████████▌                                         | 3/16 [00:09<00:42,  3.28s/it]Epoch     1:  25%|████████████▊                                      | 4/16 [00:13<00:38,  3.24s/it]Epoch     1:  31%|███████████████▉                                   | 5/16 [00:16<00:35,  3.21s/it]Epoch     1:  38%|███████████████████▏                               | 6/16 [00:19<00:31,  3.19s/it]Epoch     1:  44%|██████████████████████▎                            | 7/16 [00:22<00:28,  3.17s/it]Epoch     1:  50%|█████████████████████████▌                         | 8/16 [00:25<00:25,  3.14s/it]Epoch     1:  56%|████████████████████████████▋                      | 9/16 [00:28<00:22,  3.15s/it]Epoch     1:  62%|███████████████████████████████▎                  | 10/16 [00:32<00:19,  3.18s/it]Epoch     1:  69%|██████████████████████████████████▍               | 11/16 [00:35<00:15,  3.15s/it]Epoch     1:  75%|█████████████████████████████████████▌            | 12/16 [00:38<00:12,  3.12s/it]Epoch     1:  81%|████████████████████████████████████████▋         | 13/16 [00:41<00:09,  3.13s/it]Epoch     1:  88%|███████████████████████████████████████████▊      | 14/16 [00:44<00:06,  3.14s/it]Epoch     1:  94%|██████████████████████████████████████████████▉   | 15/16 [00:47<00:03,  3.14s/it]Epoch     1: 100%|██████████████████████████████████████████████████| 16/16 [00:50<00:00,  3.14s/it]                                                                                                    Epoch     1:   0%|                                                           | 0/16 [00:00<?, ?it/s]/mnt/qb/work/mlcolab/hzhou52/anaconda3/envs/mykt/lib/python3.9/site-packages/torch/autograd/__init__.py:173: UserWarning: Error detected in ExpBackward0. Traceback of forward call that caused the error:
  File "/mnt/qb/home/mlcolab/hzhou52/knowledge_tracing/exp/exp_learner_predict.py", line 190, in <module>
    runner.train(model, corpus)
  File "/mnt/qb/home/mlcolab/hzhou52/knowledge_tracing/exp/../KTRunner.py", line 186, in train
    loss = self.fit(model, train_batches, epoch_train_data, epoch=epoch+1, mini_epoch=mini_epoch, phase='graph')
  File "/mnt/qb/home/mlcolab/hzhou52/knowledge_tracing/exp/../KTRunner.py", line 303, in fit
    output_dict = model(batch)
  File "/mnt/qb/work/mlcolab/hzhou52/anaconda3/envs/mykt/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/mnt/qb/work/mlcolab/hzhou52/anaconda3/envs/mykt/lib/python3.9/site-packages/torch/nn/parallel/data_parallel.py", line 166, in forward
    return self.module(*inputs[0], **kwargs[0])
  File "/mnt/qb/work/mlcolab/hzhou52/anaconda3/envs/mykt/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/mnt/qb/home/mlcolab/hzhou52/knowledge_tracing/exp/../models/learner_hssm_model.py", line 973, in forward
    log_prob_yt, log_prob_zt, log_prob_st, emission_dist = self.calculate_likelihoods(
  File "/mnt/qb/home/mlcolab/hzhou52/knowledge_tracing/exp/../models/learner_hssm_model.py", line 900, in calculate_likelihoods
    log_prob_zt = self.get_z_prior(sampled_z_set, sampled_s, inputs) # [bs*n, num_steps-1]
  File "/mnt/qb/home/mlcolab/hzhou52/knowledge_tracing/exp/../models/learner_hssm_model.py", line 230, in get_z_prior
    prior_distributions, z_pred_sampled, z_entropy, z_log_prob_q, z_pred_mean, z_pred_var = self.zt_transition_func(sampled_z, sampled_s, inputs)
  File "/mnt/qb/home/mlcolab/hzhou52/knowledge_tracing/exp/../models/learner_hssm_model.py", line 666, in zt_transition_func
    decay = torch.exp(- sampled_alpha * dt)
 (Triggered internally at  ../torch/csrc/autograd/python_anomaly_mode.cpp:104.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
                                                                                                    Traceback (most recent call last):
  File "/mnt/qb/home/mlcolab/hzhou52/knowledge_tracing/exp/exp_learner_predict.py", line 190, in <module>
    runner.train(model, corpus)
  File "/mnt/qb/home/mlcolab/hzhou52/knowledge_tracing/exp/../KTRunner.py", line 186, in train
    loss = self.fit(model, train_batches, epoch_train_data, epoch=epoch+1, mini_epoch=mini_epoch, phase='graph')
  File "/mnt/qb/home/mlcolab/hzhou52/knowledge_tracing/exp/../KTRunner.py", line 306, in fit
    loss_dict['loss_total'].backward()
  File "/mnt/qb/work/mlcolab/hzhou52/anaconda3/envs/mykt/lib/python3.9/site-packages/torch/_tensor.py", line 363, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/mnt/qb/work/mlcolab/hzhou52/anaconda3/envs/mykt/lib/python3.9/site-packages/torch/autograd/__init__.py", line 173, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
RuntimeError: Function 'ExpBackward0' returned nan values in its 0th output.
