Prepare Batches:   0%|                                                       | 0/16 [00:00<?, ?it/s]                                                                                                    Epoch     1:   0%|                                                           | 0/16 [00:00<?, ?it/s]Epoch     1:   6%|███▏                                               | 1/16 [00:03<00:56,  3.75s/it]Epoch     1:  12%|██████▍                                            | 2/16 [00:07<00:48,  3.48s/it]Epoch     1:  19%|█████████▌                                         | 3/16 [00:10<00:43,  3.37s/it]Epoch     1:  25%|████████████▊                                      | 4/16 [00:13<00:39,  3.32s/it]Epoch     1:  31%|███████████████▉                                   | 5/16 [00:16<00:35,  3.23s/it]Epoch     1:  38%|███████████████████▏                               | 6/16 [00:19<00:32,  3.26s/it]Epoch     1:  44%|██████████████████████▎                            | 7/16 [00:23<00:29,  3.27s/it]Epoch     1:  50%|█████████████████████████▌                         | 8/16 [00:26<00:25,  3.23s/it]Epoch     1:  56%|████████████████████████████▋                      | 9/16 [00:29<00:22,  3.23s/it]Epoch     1:  62%|███████████████████████████████▎                  | 10/16 [00:32<00:19,  3.19s/it]Epoch     1:  69%|██████████████████████████████████▍               | 11/16 [00:35<00:15,  3.17s/it]Epoch     1:  75%|█████████████████████████████████████▌            | 12/16 [00:39<00:12,  3.19s/it]Epoch     1:  81%|████████████████████████████████████████▋         | 13/16 [00:42<00:09,  3.24s/it]Epoch     1:  88%|███████████████████████████████████████████▊      | 14/16 [00:45<00:06,  3.23s/it]Epoch     1:  94%|██████████████████████████████████████████████▉   | 15/16 [00:48<00:03,  3.19s/it]Epoch     1: 100%|██████████████████████████████████████████████████| 16/16 [00:51<00:00,  3.13s/it]                                                                                                    Epoch     1:   0%|                                                           | 0/16 [00:00<?, ?it/s]Epoch     1:   6%|███▏                                               | 1/16 [00:03<00:50,  3.34s/it]Epoch     1:  12%|██████▍                                            | 2/16 [00:06<00:44,  3.17s/it]Epoch     1:  19%|█████████▌                                         | 3/16 [00:09<00:41,  3.17s/it]Epoch     1:  25%|████████████▊                                      | 4/16 [00:12<00:37,  3.11s/it]Epoch     1:  31%|███████████████▉                                   | 5/16 [00:15<00:34,  3.15s/it]Epoch     1:  38%|███████████████████▏                               | 6/16 [00:19<00:31,  3.19s/it]Epoch     1:  44%|██████████████████████▎                            | 7/16 [00:22<00:28,  3.17s/it]Epoch     1:  50%|█████████████████████████▌                         | 8/16 [00:25<00:25,  3.17s/it]Epoch     1:  56%|████████████████████████████▋                      | 9/16 [00:28<00:21,  3.07s/it]Epoch     1:  62%|███████████████████████████████▎                  | 10/16 [00:31<00:18,  3.06s/it]Epoch     1:  69%|██████████████████████████████████▍               | 11/16 [00:34<00:15,  3.11s/it]Epoch     1:  75%|█████████████████████████████████████▌            | 12/16 [00:37<00:12,  3.12s/it]Epoch     1:  81%|████████████████████████████████████████▋         | 13/16 [00:40<00:09,  3.10s/it]Epoch     1:  88%|███████████████████████████████████████████▊      | 14/16 [00:43<00:06,  3.08s/it]Epoch     1:  94%|██████████████████████████████████████████████▉   | 15/16 [00:46<00:03,  3.10s/it]Epoch     1: 100%|██████████████████████████████████████████████████| 16/16 [00:49<00:00,  3.07s/it]                                                                                                    Epoch     1:   0%|                                                           | 0/16 [00:00<?, ?it/s]Epoch     1:   6%|███▏                                               | 1/16 [00:03<00:48,  3.24s/it]Epoch     1:  12%|██████▍                                            | 2/16 [00:06<00:43,  3.11s/it]Epoch     1:  19%|█████████▌                                         | 3/16 [00:09<00:40,  3.10s/it]Epoch     1:  25%|████████████▊                                      | 4/16 [00:12<00:37,  3.09s/it]Epoch     1:  31%|███████████████▉                                   | 5/16 [00:15<00:33,  3.08s/it]Epoch     1:  38%|███████████████████▏                               | 6/16 [00:18<00:30,  3.07s/it]Epoch     1:  44%|██████████████████████▎                            | 7/16 [00:21<00:27,  3.06s/it]Epoch     1:  50%|█████████████████████████▌                         | 8/16 [00:24<00:24,  3.05s/it]Epoch     1:  56%|████████████████████████████▋                      | 9/16 [00:27<00:21,  3.03s/it]Epoch     1:  62%|███████████████████████████████▎                  | 10/16 [00:32<00:20,  3.49s/it]Epoch     1:  69%|██████████████████████████████████▍               | 11/16 [00:35<00:17,  3.49s/it]Epoch     1:  75%|█████████████████████████████████████▌            | 12/16 [00:38<00:13,  3.43s/it]Epoch     1:  81%|████████████████████████████████████████▋         | 13/16 [00:42<00:10,  3.35s/it]Epoch     1:  88%|███████████████████████████████████████████▊      | 14/16 [00:45<00:06,  3.33s/it]Epoch     1:  94%|██████████████████████████████████████████████▉   | 15/16 [00:48<00:03,  3.32s/it]Epoch     1: 100%|██████████████████████████████████████████████████| 16/16 [00:51<00:00,  3.27s/it]                                                                                                    Epoch     1:   0%|                                                           | 0/16 [00:00<?, ?it/s]Epoch     1:   6%|███▏                                               | 1/16 [00:03<00:52,  3.53s/it]Epoch     1:  12%|██████▍                                            | 2/16 [00:06<00:45,  3.27s/it]Epoch     1:  19%|█████████▌                                         | 3/16 [00:09<00:41,  3.20s/it]Epoch     1:  25%|████████████▊                                      | 4/16 [00:12<00:38,  3.17s/it]Epoch     1:  31%|███████████████▉                                   | 5/16 [00:15<00:34,  3.12s/it]Epoch     1:  38%|███████████████████▏                               | 6/16 [00:19<00:32,  3.21s/it]Epoch     1:  44%|██████████████████████▎                            | 7/16 [00:22<00:30,  3.36s/it]Epoch     1:  50%|█████████████████████████▌                         | 8/16 [00:26<00:26,  3.29s/it]Epoch     1:  56%|████████████████████████████▋                      | 9/16 [00:29<00:22,  3.23s/it]Epoch     1:  62%|███████████████████████████████▎                  | 10/16 [00:32<00:19,  3.20s/it]Epoch     1:  69%|██████████████████████████████████▍               | 11/16 [00:35<00:15,  3.11s/it]Epoch     1:  75%|█████████████████████████████████████▌            | 12/16 [00:38<00:12,  3.13s/it]Epoch     1:  81%|████████████████████████████████████████▋         | 13/16 [00:41<00:09,  3.14s/it]Epoch     1:  88%|███████████████████████████████████████████▊      | 14/16 [00:44<00:06,  3.16s/it]Epoch     1:  94%|██████████████████████████████████████████████▉   | 15/16 [00:48<00:03,  3.18s/it]Epoch     1: 100%|██████████████████████████████████████████████████| 16/16 [00:51<00:00,  3.15s/it]                                                                                                    Epoch     1:   0%|                                                           | 0/16 [00:00<?, ?it/s]Epoch     1:   6%|███▏                                               | 1/16 [00:03<00:51,  3.45s/it]Epoch     1:  12%|██████▍                                            | 2/16 [00:06<00:47,  3.38s/it]Epoch     1:  19%|█████████▌                                         | 3/16 [00:09<00:42,  3.27s/it]Epoch     1:  25%|████████████▊                                      | 4/16 [00:13<00:38,  3.24s/it]Epoch     1:  31%|███████████████▉                                   | 5/16 [00:16<00:35,  3.24s/it]Epoch     1:  38%|███████████████████▏                               | 6/16 [00:28<01:01,  6.18s/it]Epoch     1:  44%|██████████████████████▎                            | 7/16 [00:46<01:30, 10.02s/it]Epoch     1:  50%|█████████████████████████▌                         | 8/16 [00:50<01:06,  8.37s/it]Epoch     1:  56%|████████████████████████████▋                      | 9/16 [00:55<00:50,  7.28s/it]Epoch     1:  62%|███████████████████████████████▎                  | 10/16 [01:01<00:39,  6.66s/it]Epoch     1:  69%|██████████████████████████████████▍               | 11/16 [01:06<00:31,  6.23s/it]Epoch     1:  75%|█████████████████████████████████████▌            | 12/16 [01:11<00:23,  5.91s/it]Epoch     1:  81%|████████████████████████████████████████▋         | 13/16 [01:16<00:16,  5.66s/it]Epoch     1:  88%|███████████████████████████████████████████▊      | 14/16 [01:21<00:11,  5.55s/it]Epoch     1:  94%|██████████████████████████████████████████████▉   | 15/16 [01:26<00:05,  5.38s/it]Epoch     1: 100%|██████████████████████████████████████████████████| 16/16 [01:31<00:00,  5.20s/it]                                                                                                    Epoch     1:   0%|                                                           | 0/16 [00:00<?, ?it/s]/mnt/qb/work/mlcolab/hzhou52/anaconda3/envs/mykt/lib/python3.9/site-packages/torch/autograd/__init__.py:173: UserWarning: Error detected in ExpBackward0. Traceback of forward call that caused the error:
  File "/mnt/qb/home/mlcolab/hzhou52/knowledge_tracing/exp/exp_learner_predict.py", line 190, in <module>
    runner.train(model, corpus)
  File "/mnt/qb/home/mlcolab/hzhou52/knowledge_tracing/exp/../KTRunner.py", line 186, in train
    model.train()
  File "/mnt/qb/home/mlcolab/hzhou52/knowledge_tracing/exp/../KTRunner.py", line 303, in fit
    # out_dicts.append(output_dict)
  File "/mnt/qb/work/mlcolab/hzhou52/anaconda3/envs/mykt/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/mnt/qb/work/mlcolab/hzhou52/anaconda3/envs/mykt/lib/python3.9/site-packages/torch/nn/parallel/data_parallel.py", line 166, in forward
    return self.module(*inputs[0], **kwargs[0])
  File "/mnt/qb/work/mlcolab/hzhou52/anaconda3/envs/mykt/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/mnt/qb/home/mlcolab/hzhou52/knowledge_tracing/exp/../models/learner_hssm_model.py", line 973, in forward
    log_prob_yt, log_prob_zt, log_prob_st, emission_dist = self.calculate_likelihoods(
  File "/mnt/qb/home/mlcolab/hzhou52/knowledge_tracing/exp/../models/learner_hssm_model.py", line 900, in calculate_likelihoods
    log_prob_zt = self.get_z_prior(sampled_z_set, sampled_s, inputs) # [bs*n, num_steps-1]
  File "/mnt/qb/home/mlcolab/hzhou52/knowledge_tracing/exp/../models/learner_hssm_model.py", line 230, in get_z_prior
    prior_distributions, z_pred_sampled, z_entropy, z_log_prob_q, z_pred_mean, z_pred_var = self.zt_transition_func(sampled_z, sampled_s, inputs)
  File "/mnt/qb/home/mlcolab/hzhou52/knowledge_tracing/exp/../models/learner_hssm_model.py", line 666, in zt_transition_func
    decay = torch.exp(- sampled_alpha * dt)
 (Triggered internally at  ../torch/csrc/autograd/python_anomaly_mode.cpp:104.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
                                                                                                    Traceback (most recent call last):
  File "/mnt/qb/home/mlcolab/hzhou52/knowledge_tracing/exp/exp_learner_predict.py", line 190, in <module>
    runner.train(model, corpus)
  File "/mnt/qb/home/mlcolab/hzhou52/knowledge_tracing/exp/../KTRunner.py", line 186, in train
    model.train()
  File "/mnt/qb/home/mlcolab/hzhou52/knowledge_tracing/exp/../KTRunner.py", line 306, in fit
    # model.module.optimizer_graph.step()
  File "/mnt/qb/work/mlcolab/hzhou52/anaconda3/envs/mykt/lib/python3.9/site-packages/torch/_tensor.py", line 363, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/mnt/qb/work/mlcolab/hzhou52/anaconda3/envs/mykt/lib/python3.9/site-packages/torch/autograd/__init__.py", line 173, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
RuntimeError: Function 'ExpBackward0' returned nan values in its 0th output.
